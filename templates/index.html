<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criar Novo Curso - Ciclo Carioca</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // FOR√áAR RESET DO CAMPO MODALIDADE NA P√ÅGINA PRINCIPAL
            function resetModalidadeField() {
                // Reset do campo modalidade
                const modalidadeSelect = document.getElementById('modalidade');
                if (modalidadeSelect) {
                    // For√ßar sele√ß√£o da op√ß√£o padr√£o (vazia)
                    modalidadeSelect.selectedIndex = 0;
                    modalidadeSelect.value = '';

                    // Garantir que os containers de unidades/plataforma estejam ocultos
                    const unidadesContainer = document.getElementById('unidades_container');
                    const plataformaContainer = document.getElementById('plataforma_container');

                    if (unidadesContainer) {
                        unidadesContainer.style.display = 'none';
                    }
                    if (plataformaContainer) {
                        plataformaContainer.style.display = 'none';
                    }

                    // Chamar toggleUnidades para garantir que os containers estejam ocultos
                    if (typeof toggleUnidades === 'function') {
                        toggleUnidades();
                    }

                    console.log('üîÑ Campo modalidade resetado para for√ßar nova sele√ß√£o');
                }

                // Reset do campo acessibilidade
                const acessibilidadeSelect = document.getElementById('acessibilidade');
                if (acessibilidadeSelect) {
                    // For√ßar sele√ß√£o da op√ß√£o padr√£o (vazia)
                    acessibilidadeSelect.selectedIndex = 0;
                    acessibilidadeSelect.value = '';

                    // Garantir que o container de recursos de acessibilidade esteja oculto
                    const recursosContainer = document.getElementById('recursos_acessibilidade_container');
                    if (recursosContainer) {
                        recursosContainer.style.display = 'none';
                    }

                    // Chamar toggleRecursosAcessibilidade para garantir que o container esteja oculto
                    if (typeof toggleRecursosAcessibilidade === 'function') {
                        toggleRecursosAcessibilidade();
                    }

                    console.log('üîÑ Campo acessibilidade resetado para for√ßar nova sele√ß√£o');
                }
            }

            // Executar reset imediatamente
            resetModalidadeField();

            // Executar reset novamente ap√≥s um pequeno delay para garantir
            setTimeout(resetModalidadeField, 100);

            // Adicionar listener para quando a p√°gina √© carregada do cache (back/forward)
            window.addEventListener('pageshow', function (event) {
                if (event.persisted) {
                    console.log('üîÑ P√°gina carregada do cache, resetando modalidade...');
                    resetModalidadeField();
                }
            });

            // Definir a data atual como valor padr√£o para os campos de data
            function setDataAtual() {
                const hoje = new Date();
                const ano = hoje.getFullYear();
                const mes = String(hoje.getMonth() + 1).padStart(2, '0');
                const dia = String(hoje.getDate()).padStart(2, '0');
                const dataAtual = `${ano}-${mes}-${dia}`;

                document.getElementById('inicio_inscricoes_data').value = dataAtual;
                document.getElementById('fim_inscricoes_data').value = dataAtual;
            }

            // Fun√ß√£o para formatar datas no formato brasileiro
            function formatarDataBrasileira() {
                const camposData = document.querySelectorAll('input[type="date"]');
                camposData.forEach(campo => {
                    campo.addEventListener('change', function () {
                        if (this.value) {
                            const [ano, mes, dia] = this.value.split('-');
                            const dataFormatada = `${dia}/${mes}/${ano}`;
                            // Exibe a data formatada em um elemento adjacente ou tooltip
                            this.setAttribute('title', `Data: ${dataFormatada}`);
                        }
                    });
                    // Formatar datas j√° preenchidas
                    if (campo.value) {
                        const [ano, mes, dia] = campo.value.split('-');
                        const dataFormatada = `${dia}/${mes}/${ano}`;
                        campo.setAttribute('title', `Data: ${dataFormatada}`);
                    }
                });
            }

            // Fun√ß√£o para limpar todos os campos do formul√°rio, exceto campos de data
            function limparFormulario() {
                // Limpar campos de texto
                const camposTexto = document.querySelectorAll('input[type="text"], input[type="email"], input[type="url"], textarea');
                camposTexto.forEach(campo => {
                    campo.value = '';
                });

                // Limpar campos de n√∫mero
                const camposNumero = document.querySelectorAll('input[type="number"]');
                camposNumero.forEach(campo => {
                    campo.value = '';
                });

                // Limpar campos de tempo
                const camposTempo = document.querySelectorAll('input[type="time"]');
                camposTempo.forEach(campo => {
                    campo.value = '';
                });

                // Limpar selects (exceto campos de data que j√° t√™m valores padr√£o)
                const selects = document.querySelectorAll('select');
                selects.forEach(select => {
                    // N√£o limpar selects de data que j√° t√™m valores padr√£o
                    if (!select.id.includes('data') && !select.id.includes('Data')) {
                        select.selectedIndex = 0;
                    }
                });

                // Limpar checkboxes
                const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });

                // Limpar radio buttons
                const radioButtons = document.querySelectorAll('input[type="radio"]');
                radioButtons.forEach(radio => {
                    radio.checked = false;
                });

                // Limpar campos de arquivo
                const camposArquivo = document.querySelectorAll('input[type="file"]');
                camposArquivo.forEach(campo => {
                    campo.value = '';
                });

                // Remover unidades adicionais (manter apenas a primeira)
                const unidadesAdicionais = document.querySelectorAll('.unidade-item:not(:first-child)');
                unidadesAdicionais.forEach(unidade => {
                    unidade.remove();
                });

                // Remover plataformas adicionais (manter apenas a primeira)
                const plataformasAdicionais = document.querySelectorAll('.plataforma-item:not(:first-child)');
                plataformasAdicionais.forEach(plataforma => {
                    plataforma.remove();
                });

                // Resetar contadores de unidades e plataformas
                if (window.formManager) {
                    window.formManager.unidades = 1;
                    window.formManager.plataformas = 1;
                    window.formManager.updateRemoveButtonsVisibility();
                    window.formManager.updateRemovePlataformaButtonsVisibility();
                }

                // Limpar mensagens de erro visuais
                const camposComErro = document.querySelectorAll('.campo-erro');
                camposComErro.forEach(campo => {
                    campo.classList.remove('campo-erro');
                });

                // Limpar tooltips de valida√ß√£o
                const tooltips = document.querySelectorAll('[title*="Data:"]');
                tooltips.forEach(tooltip => {
                    tooltip.removeAttribute('title');
                });

                // Limpar campos espec√≠ficos de modalidades (for√ßar limpeza)
                limparCamposModalidade();

                console.log('Formul√°rio limpo com sucesso!');
            }

            // Fun√ß√£o para limpar campos espec√≠ficos de modalidades
            function limparCamposModalidade() {
                // Campos que devem ser limpos independente da modalidade
                const camposPresencial = [
                    'input[name="endereco_unidade[]"]',
                    'input[name="bairro_unidade[]"]',
                    'input[name="vagas_unidade[]"]',
                    'input[name="inicio_aulas_data[]"]',
                    'input[name="fim_aulas_data[]"]',
                    'select[name="horario_inicio[]"]',
                    'select[name="horario_fim[]"]'
                ];

                const camposOnline = [
                    'input[name="plataforma_digital"]'
                ];

                // Limpar todos os campos de modalidade
                [...camposPresencial, ...camposOnline].forEach(seletor => {
                    const campos = document.querySelectorAll(seletor);
                    campos.forEach(campo => {
                        if (campo.type === 'text' || campo.type === 'number' || campo.type === 'date' || campo.type === 'time') {
                            campo.value = '';
                        } else if (campo.tagName === 'SELECT') {
                            campo.selectedIndex = 0;
                        }
                    });
                });

                // Limpar checkboxes de dias da semana
                const diasCheckboxes = document.querySelectorAll('input[name="dias_aula[]"]');
                diasCheckboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });

                console.log('Campos de modalidade limpos com sucesso!');
            }

            // Fun√ß√£o para limpar campos baseada na modalidade selecionada
            function limparCamposPorModalidade(modalidade) {
                if (modalidade === 'Online') {
                    // Limpar campos espec√≠ficos de Presencial/H√≠brido
                    const camposPresencial = [
                        'input[name="endereco_unidade[]"]',
                        'input[name="bairro_unidade[]"]',
                        'input[name="inicio_aulas_data[]"]',
                        'input[name="fim_aulas_data[]"]'
                    ];

                    camposPresencial.forEach(seletor => {
                        const campos = document.querySelectorAll(seletor);
                        campos.forEach(campo => {
                            campo.value = '';
                        });
                    });

                    // Limpar hor√°rios apenas se aulas forem ass√≠ncronas
                    const aulasAssincronasSim = document.querySelector('input[name="aulas_assincronas"][value="sim"]');
                    if (aulasAssincronasSim && aulasAssincronasSim.checked) {
                        const camposHorario = [
                            'select[name="horario_inicio[]"]',
                            'select[name="horario_fim[]"]'
                        ];

                        camposHorario.forEach(seletor => {
                            const campos = document.querySelectorAll(seletor);
                            campos.forEach(campo => {
                                campo.selectedIndex = 0; // Reset para primeira op√ß√£o (vazia)
                            });
                        });
                    }

                    console.log('Campos de Presencial/H√≠brido limpos para modalidade Online');
                } else if (modalidade === 'Presencial' || modalidade === 'H√≠brido') {
                    // Limpar campos espec√≠ficos de Online
                    const camposOnline = [
                        'input[name="plataforma_digital"]'
                    ];

                    camposOnline.forEach(seletor => {
                        const campos = document.querySelectorAll(seletor);
                        campos.forEach(campo => {
                            if (campo.type === 'text') {
                                campo.value = '';
                            }
                        });
                    });

                    console.log('Campos de Online limpos para modalidade Presencial/H√≠brido');
                }
            }

            // Fun√ß√£o para limpar hor√°rios quando aulas ass√≠ncronas s√£o selecionadas
            function limparHorariosSeAssincronas() {
                const aulasAssincronasSim = document.querySelector('input[name="aulas_assincronas"][value="sim"]');
                if (aulasAssincronasSim && aulasAssincronasSim.checked) {
                    const camposHorario = [
                        'select[name="horario_inicio[]"]',
                        'select[name="horario_fim[]"]'
                    ];

                    camposHorario.forEach(seletor => {
                        const campos = document.querySelectorAll(seletor);
                        campos.forEach(campo => {
                            campo.selectedIndex = 0; // Reset para primeira op√ß√£o (vazia)
                        });
                    });

                    console.log('Hor√°rios limpos para aulas ass√≠ncronas');
                }
            }

            // Executar limpeza do formul√°rio
            limparFormulario();

            // Garantir que modalidade seja resetada ap√≥s limpeza
            setTimeout(resetModalidadeField, 200);

            // Definir valores padr√£o para campos de data
            setDataAtual();
            formatarDataBrasileira();

            // Adicionar event listener para limpar campos quando modalidade mudar
            const modalidadeSelect = document.querySelector('select[name="modalidade"]');
            if (modalidadeSelect) {
                modalidadeSelect.addEventListener('change', function () {
                    const modalidadeSelecionada = this.value;
                    limparCamposPorModalidade(modalidadeSelecionada);
                });
            }

            // Adicionar event listener para limpar hor√°rios quando aulas ass√≠ncronas mudar
            const aulasAssincronasRadios = document.querySelectorAll('input[name="aulas_assincronas"]');
            aulasAssincronasRadios.forEach(radio => {
                radio.addEventListener('change', function () {
                    limparHorariosSeAssincronas();
                });
            });
        });
    </script>
</head>

<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-container">
            <div class="loading-spinner">
                <div class="spinner-ring"></div>
            </div>
            <div class="loading-text">Processando Curso...</div>
            <div class="loading-description">
                Aguarde enquanto processamos as informa√ß√µes do curso
            </div>
            <div class="loading-progress">
                <div class="loading-progress-bar" id="loadingProgressBar"></div>
            </div>
            <div class="loading-steps">
                <div class="loading-step" id="step1">
                    <div class="step-icon">1</div>
                    <span>Validando informa√ß√µes</span>
                </div>
                <div class="loading-step" id="step2">
                    <div class="step-icon">2</div>
                    <span>Processando imagens</span>
                </div>
                <div class="loading-step" id="step3">
                    <div class="step-icon">3</div>
                    <span>Melhorando descri√ß√£o com IA</span>
                </div>
                <div class="loading-step" id="step4">
                    <div class="step-icon">4</div>
                    <span>Gerando arquivos CSV e PDF</span>
                </div>
                <div class="loading-step" id="step5">
                    <div class="step-icon">5</div>
                    <span>Finalizando cadastro</span>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
                    <a href="{{ url_for('index') }}" title="Ir para p√°gina inicial">
                        <img src="{{ url_for('static', filename='images/logo_ciclocarioca..png') }}"
                            alt="Logo Ciclo Carioca">
                    </a>
                    <span class="version">v2.0</span>
                </div>
                <div class="nav-section">
                    <a href="{{ url_for('public_courses') }}" class="nav-link">
                        <i class="fas fa-list"></i>
                        Ver Cursos
                    </a>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="form-container">
                <div class="form-header">
                    {% if duplicate_data %}
                    <h2><i class="fas fa-copy"></i> Duplicar Curso</h2>
                    <p class="form-description">Formul√°rio pr√©-preenchido com dados do curso selecionado. Edite as
                        informa√ß√µes necess√°rias.</p>
                    <div class="duplicate-notice">
                        <i class="fas fa-info-circle"></i>
                        <strong>Duplicando:</strong> {{ duplicate_data.titulo_original or 'Curso selecionado' }}
                    </div>
                    {% else %}
                    <h2><i class="fas fa-plus-circle"></i> Criar Novo Curso</h2>
                    <p class="form-description">Preencha as informa√ß√µes abaixo para criar um novo curso na plataforma
                    </p>
                    {% endif %}
                </div>

                <!-- Flash Messages -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                {% for category, message in messages %}
                <div class="alert alert-{{ category }}">
                    {% if category == 'success' %}
                    <i class="fas fa-check-circle"></i>
                    <strong>Sucesso!</strong> {{ message }}
                    {% elif category == 'error' %}
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Erro de Valida√ß√£o:</strong> {{ message }}
                    {% elif category == 'warning' %}
                    <i class="fas fa-exclamation-circle"></i>
                    <strong>Aten√ß√£o:</strong> {{ message }}
                    {% else %}
                    <i class="fas fa-info-circle"></i>
                    {{ message }}
                    {% endif %}
                </div>
                {% endfor %}
                {% endif %}
                {% endwith %}

                <form method="POST" action="{{ url_for('create_course') }}" class="course-form"
                    enctype="multipart/form-data">
                    <!-- Formul√°rio de Cria√ß√£o de Curso -->
                    <div class="form-section">
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label for="titulo" class="required">Nome do Curso</label>
                                <input type="text" id="titulo" name="titulo" required
                                    placeholder="Digite o t√≠tulo do curso"
                                    value="{{ duplicate_data.titulo if duplicate_data else '' }}">
                                {% if duplicate_data and duplicate_data.titulo_original %}
                                <small class="form-help">
                                    <i class="fas fa-info-circle"></i>
                                    {{ duplicate_data.titulo_original }}
                                </small>
                                {% endif %}
                            </div>

                            <div class="form-group full-width">
                                <label for="descricao" class="required">Descri√ß√£o</label>
                                <textarea id="descricao" name="descricao" rows="6" required
                                    placeholder="Digite a descri√ß√£o do curso">{{ duplicate_data.descricao_original if duplicate_data else '' }}</textarea>
                            </div>

                            <div class="form-group full-width">
                                <label for="capa_curso">Capa do Curso</label>
                                <div class="file-upload-container">
                                    <input type="file" id="capa_curso" name="capa_curso"
                                        accept=".jpeg,.png,.jpg,.bmp,image/jpeg,image/png,image/jpg,image/bmp">
                                    <div class="file-upload-display">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <span class="file-upload-text">Clique para selecionar uma imagem</span>
                                        <div class="image-instructions">
                                            <div class="instruction-list">
                                                <p><strong>Instru√ß√µes para envio de imagem:</strong></p>
                                                <ul>
                                                    <li>Dimens√£o obrigat√≥ria: 1080 x 1080 px.</li>
                                                    <li>N√£o utilizar grafismos, textos ou logotipos. Utilizar poucos
                                                        elementos visuais e de f√°cil leitura.</li>
                                                    <li>Escolha imagens que sejam representativas do curso ao qual se
                                                        referem.</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="inicio_inscricoes" class="required">In√≠cio das inscri√ß√µes</label>
                                <div class="datetime-group">
                                    <input type="date" id="inicio_inscricoes_data" name="inicio_inscricoes_data"
                                        value="{{ today_date }}" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="fim_inscricoes" class="required">Fim das inscri√ß√µes</label>
                                <div class="datetime-group">
                                    <input type="date" id="fim_inscricoes_data" name="fim_inscricoes_data"
                                        value="{{ today_date }}" required>
                                </div>
                            </div>

                            <div class="form-group full-width">
                                <label for="orgao" class="required">√ìrg√£o (Quem oferece o curso)</label>
                                <select id="orgao" name="orgao" required>
                                    <option value="">Selecione um √≥rg√£o</option>
                                    {% for orgao in orgaos %}
                                    <option value="{{ orgao }}" {% if duplicate_data and duplicate_data.orgao==orgao
                                        %}selected{% endif %}>
                                        {{ orgao }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>



                            <div class="form-group full-width">
                                <label for="tema" class="required">Categoria</label>
                                <select id="tema" name="tema" required>
                                    <option value="">Selecione a categoria</option>
                                    <option value="Tech">Tech</option>
                                    <option value="Dados">Dados</option>
                                    <option value="IA">IA</option>
                                    <option value="Design">Design</option>
                                    <option value="Ciberseguran√ßa">Ciberseguran√ßa</option>
                                    <option value="Marketing">Marketing</option>
                                    <option value="Finan√ßas">Finan√ßas</option>
                                    <option value="Gest√£o">Gest√£o</option>
                                    <option value="Games">Games</option>
                                    <option value="Nutri√ß√£o">Nutri√ß√£o</option>
                                    <option value="Educa√ß√£o">Educa√ß√£o</option>
                                    <option value="Gastronomia">Gastronomia</option>
                                    <option value="Sa√∫de">Sa√∫de</option>
                                    <option value="Veterin√°ria">Veterin√°ria</option>
                                    <option value="Carreira">Carreira</option>
                                    <option value="Est√©tica">Est√©tica</option>
                                    <option value="Sustentabilidade">Sustentabilidade</option>
                                    <option value="Artes">Artes</option>
                                    <option value="Cultura">Cultura</option>
                                    <option value="Astronomia">Astronomia</option>
                                </select>
                            </div>

                            <div class="form-group full-width">
                                <label for="modalidade" class="required">Modalidade</label>
                                <select id="modalidade" name="modalidade" required onchange="toggleUnidades();"
                                    autocomplete="off">
                                    <option value="">Selecione a modalidade</option>
                                    <option value="Presencial">Presencial</option>
                                    <option value="Online">Online</option>
                                    <option value="H√≠brido">H√≠brido</option>
                                </select>
                            </div>

                            <!-- Subformul√°rio para Presencial/H√≠brido -->
                            <div class="form-group full-width" id="unidades_container"
                                style="display:{% if duplicate_data and (duplicate_data.modalidade|lower == 'presencial' or duplicate_data.modalidade|lower == 'h√≠brido') %}block{% else %}none{% endif %};">
                                <fieldset class="unidade-fieldset">
                                    <legend>Informa√ß√µes das Unidades <button type="button" class="remove-unidade-btn"
                                            onclick="removeUnidade(this)" style="display:none;">√ó</button></legend>

                                    <!-- Container para m√∫ltiplas unidades -->
                                    <div id="unidades_list">
                                        {% if duplicate_data and duplicate_data.enderecos_unidades %}
                                        <!-- Renderizar unidades existentes na duplica√ß√£o -->
                                        {% for i in range(duplicate_data.enderecos_unidades|length) %}
                                        <div class="unidade-item" data-unidade="{{ i }}">
                                            <div class="unidade-header">
                                                <h4>Unidade {{ i + 1 }}</h4>
                                                {% if i > 0 %}
                                                <button type="button" class="btn-remove-unidade"
                                                    onclick="removeUnidade({{ i }})">
                                                    <i class="fas fa-trash"></i> Remover Unidade
                                                </button>
                                                {% endif %}
                                            </div>
                                            <label>Endere√ßo da unidade*</label>
                                            <input type="text" name="endereco_unidade[]" required
                                                value="{{ duplicate_data.enderecos_unidades[i] if i < duplicate_data.enderecos_unidades|length else '' }}">
                                            <label>Bairro*</label>
                                            <input type="text" name="bairro_unidade[]" required
                                                value="{{ duplicate_data.bairros_unidades[i] if i < duplicate_data.bairros_unidades|length else '' }}">
                                            <label>Total de vagas*</label>
                                            <input type="number" name="vagas_unidade[]" min="1" required
                                                value="{{ duplicate_data.vagas_unidades[i] if i < duplicate_data.vagas_unidades|length else '' }}">

                                            <label for="carga_horaria_unidade_{{ i }}" class="required">Carga
                                                Hor√°ria</label>
                                            <input type="text" id="carga_horaria_unidade_{{ i }}" name="carga_horaria"
                                                required
                                                placeholder="Digite a carga hor√°ria (ex: 40 horas, 80h, 2 meses, etc.)"
                                                value="{{ duplicate_data.carga_horaria if i == 0 else '' }}">
                                            <small
                                                style="color: red; font-size: 0.9em; margin-top: 5px; display: block;">(D√™
                                                prefer√™ncia a carga hor√°ria no formato de horas)</small>

                                            <div class="data-group">
                                                <div class="data-field">
                                                    <label>In√≠cio das aulas*</label>
                                                    <input type="date" name="inicio_aulas_data[]" required
                                                        value="{{ duplicate_data.inicio_aulas_unidades[i] if i < duplicate_data.inicio_aulas_unidades|length else today_date }}">
                                                </div>
                                                <div class="data-field">
                                                    <label>Fim das aulas*</label>
                                                    <input type="date" name="fim_aulas_data[]" required
                                                        value="{{ duplicate_data.fim_aulas_unidades[i] if i < duplicate_data.fim_aulas_unidades|length else today_date }}">
                                                </div>
                                            </div>

                                            <div class="horario-group">
                                                <div class="horario-field">
                                                    <label>Hor√°rio-In√≠cio*</label>
                                                    <select name="horario_inicio[]" required>
                                                        <option value="">Selecione o hor√°rio</option>
                                                        <option value="06:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='06:00'
                                                            %}selected{% endif %}>06:00</option>
                                                        <option value="07:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='07:00'
                                                            %}selected{% endif %}>07:00</option>
                                                        <option value="08:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='08:00'
                                                            %}selected{% endif %}>08:00</option>
                                                        <option value="09:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='09:00'
                                                            %}selected{% endif %}>09:00</option>
                                                        <option value="10:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='10:00'
                                                            %}selected{% endif %}>10:00</option>
                                                        <option value="11:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='11:00'
                                                            %}selected{% endif %}>11:00</option>
                                                        <option value="12:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='12:00'
                                                            %}selected{% endif %}>12:00</option>
                                                        <option value="13:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='13:00'
                                                            %}selected{% endif %}>13:00</option>
                                                        <option value="14:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='14:00'
                                                            %}selected{% endif %}>14:00</option>
                                                        <option value="15:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='15:00'
                                                            %}selected{% endif %}>15:00</option>
                                                        <option value="16:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='16:00'
                                                            %}selected{% endif %}>16:00</option>
                                                        <option value="17:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='17:00'
                                                            %}selected{% endif %}>17:00</option>
                                                        <option value="18:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='18:00'
                                                            %}selected{% endif %}>18:00</option>
                                                        <option value="19:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='19:00'
                                                            %}selected{% endif %}>19:00</option>
                                                        <option value="20:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='20:00'
                                                            %}selected{% endif %}>20:00</option>
                                                        <option value="21:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='21:00'
                                                            %}selected{% endif %}>21:00</option>
                                                        <option value="22:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='22:00'
                                                            %}selected{% endif %}>22:00</option>
                                                        <option value="23:00" {% if
                                                            duplicate_data.horario_inicio_unidades[i]=='23:00'
                                                            %}selected{% endif %}>23:00</option>
                                                    </select>
                                                </div>
                                                <div class="horario-field">
                                                    <label>Hor√°rio-Fim*</label>
                                                    <select name="horario_fim[]" required>
                                                        <option value="">Selecione o hor√°rio</option>
                                                        <option value="06:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='06:00' %}selected{%
                                                            endif %}>06:00</option>
                                                        <option value="07:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='07:00' %}selected{%
                                                            endif %}>07:00</option>
                                                        <option value="08:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='08:00' %}selected{%
                                                            endif %}>08:00</option>
                                                        <option value="09:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='09:00' %}selected{%
                                                            endif %}>09:00</option>
                                                        <option value="10:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='10:00' %}selected{%
                                                            endif %}>10:00</option>
                                                        <option value="11:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='11:00' %}selected{%
                                                            endif %}>11:00</option>
                                                        <option value="12:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='12:00' %}selected{%
                                                            endif %}>12:00</option>
                                                        <option value="13:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='13:00' %}selected{%
                                                            endif %}>13:00</option>
                                                        <option value="14:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='14:00' %}selected{%
                                                            endif %}>14:00</option>
                                                        <option value="15:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='15:00' %}selected{%
                                                            endif %}>15:00</option>
                                                        <option value="16:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='16:00' %}selected{%
                                                            endif %}>16:00</option>
                                                        <option value="17:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='17:00' %}selected{%
                                                            endif %}>17:00</option>
                                                        <option value="18:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='18:00' %}selected{%
                                                            endif %}>18:00</option>
                                                        <option value="19:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='19:00' %}selected{%
                                                            endif %}>19:00</option>
                                                        <option value="20:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='20:00' %}selected{%
                                                            endif %}>20:00</option>
                                                        <option value="21:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='21:00' %}selected{%
                                                            endif %}>21:00</option>
                                                        <option value="22:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='22:00' %}selected{%
                                                            endif %}>22:00</option>
                                                        <option value="23:00" {% if
                                                            duplicate_data.horario_fim_unidades[i]=='23:00' %}selected{%
                                                            endif %}>23:00</option>
                                                    </select>
                                                </div>
                                            </div>

                                            <label>Dias da semana*</label>
                                            <select name="dias_aula[]" required>
                                                <option value="">Selecione os dias</option>
                                                <option value="Segunda-feira" {% if
                                                    duplicate_data.dias_aula_unidades[i]=='Segunda-feira' %}selected{%
                                                    endif %}>Segunda-feira</option>
                                                <option value="Ter√ßa-feira" {% if
                                                    duplicate_data.dias_aula_unidades[i]=='Ter√ßa-feira' %}selected{%
                                                    endif %}>Ter√ßa-feira</option>
                                                <option value="Quarta-feira" {% if
                                                    duplicate_data.dias_aula_unidades[i]=='Quarta-feira' %}selected{%
                                                    endif %}>Quarta-feira</option>
                                                <option value="Quinta-feira" {% if
                                                    duplicate_data.dias_aula_unidades[i]=='Quinta-feira' %}selected{%
                                                    endif %}>Quinta-feira</option>
                                                <option value="Sexta-feira" {% if
                                                    duplicate_data.dias_aula_unidades[i]=='Sexta-feira' %}selected{%
                                                    endif %}>Sexta-feira</option>
                                                <option value="S√°bado" {% if
                                                    duplicate_data.dias_aula_unidades[i]=='S√°bado' %}selected{% endif
                                                    %}>S√°bado</option>
                                                <option value="Domingo" {% if
                                                    duplicate_data.dias_aula_unidades[i]=='Domingo' %}selected{% endif
                                                    %}>Domingo</option>
                                            </select>
                                        </div>
                                        {% endfor %}
                                        {% else %}
                                        <!-- Primeira unidade padr√£o (quando n√£o h√° duplica√ß√£o) -->
                                        <div class="unidade-item" data-unidade="0">
                                            <label>Endere√ßo da unidade*</label>
                                            <input type="text" name="endereco_unidade[]" required>
                                            <label>Bairro*</label>
                                            <input type="text" name="bairro_unidade[]" required>
                                            <label>Total de vagas*</label>
                                            <input type="number" name="vagas_unidade[]" min="1" required>
                                            {% endif %}

                                            <label for="carga_horaria_unidade" class="required">Carga Hor√°ria</label>
                                            <input type="text" id="carga_horaria_unidade" name="carga_horaria" required
                                                placeholder="Digite a carga hor√°ria (ex: 40 horas, 80h, 2 meses, etc.)">
                                            <small
                                                style="color: red; font-size: 0.9em; margin-top: 5px; display: block;">(D√™
                                                prefer√™ncia a carga hor√°ria no formato de horas)</small>

                                            <div class="data-group">
                                                <div class="data-field">
                                                    <label>In√≠cio das aulas*</label>
                                                    <input type="date" name="inicio_aulas_data[]"
                                                        value="{{ today_date }}" required>
                                                </div>
                                                <div class="data-field">
                                                    <label>Fim das aulas*</label>
                                                    <input type="date" name="fim_aulas_data[]" value="{{ today_date }}"
                                                        required>
                                                </div>
                                            </div>
                                            <div class="horario-group">
                                                <div class="horario-field">
                                                    <label>Hor√°rio-In√≠cio*</label>
                                                    <select name="horario_inicio[]" required>
                                                        <option value="">Selecione o hor√°rio</option>
                                                        <option value="06:00">06:00</option>
                                                        <option value="07:00">07:00</option>
                                                        <option value="08:00">08:00</option>
                                                        <option value="09:00">09:00</option>
                                                        <option value="10:00">10:00</option>
                                                        <option value="11:00">11:00</option>
                                                        <option value="12:00">12:00</option>
                                                        <option value="13:00">13:00</option>
                                                        <option value="14:00">14:00</option>
                                                        <option value="15:00">15:00</option>
                                                        <option value="16:00">16:00</option>
                                                        <option value="17:00">17:00</option>
                                                        <option value="18:00">18:00</option>
                                                        <option value="19:00">19:00</option>
                                                        <option value="20:00">20:00</option>
                                                        <option value="21:00">21:00</option>
                                                        <option value="22:00">22:00</option>
                                                        <option value="23:00">23:00</option>
                                                    </select>
                                                </div>
                                                <div class="horario-field">
                                                    <label>Hor√°rio-Fim*</label>
                                                    <select name="horario_fim[]" required>
                                                        <option value="">Selecione o hor√°rio</option>
                                                        <option value="06:00">06:00</option>
                                                        <option value="07:00">07:00</option>
                                                        <option value="08:00">08:00</option>
                                                        <option value="09:00">09:00</option>
                                                        <option value="10:00">10:00</option>
                                                        <option value="11:00">11:00</option>
                                                        <option value="12:00">12:00</option>
                                                        <option value="13:00">13:00</option>
                                                        <option value="14:00">14:00</option>
                                                        <option value="15:00">15:00</option>
                                                        <option value="16:00">16:00</option>
                                                        <option value="17:00">17:00</option>
                                                        <option value="18:00">18:00</option>
                                                        <option value="19:00">19:00</option>
                                                        <option value="20:00">20:00</option>
                                                        <option value="21:00">21:00</option>
                                                        <option value="22:00">22:00</option>
                                                        <option value="23:00">23:00</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <label>Dias de aula*</label>
                                            <div class="checkbox-group dias-aula">
                                                <label class="checkbox-label">
                                                    <input type="checkbox" name="dias_aula[]" value="Segunda-feira">
                                                    <span>Segunda-feira</span>
                                                </label>
                                                <label class="checkbox-label">
                                                    <input type="checkbox" name="dias_aula[]" value="Ter√ßa-feira">
                                                    <span>Ter√ßa-feira</span>
                                                </label>
                                                <label class="checkbox-label">
                                                    <input type="checkbox" name="dias_aula[]" value="Quarta-feira">
                                                    <span>Quarta-feira</span>
                                                </label>
                                                <label class="checkbox-label">
                                                    <input type="checkbox" name="dias_aula[]" value="Quinta-feira">
                                                    <span>Quinta-feira</span>
                                                </label>
                                                <label class="checkbox-label">
                                                    <input type="checkbox" name="dias_aula[]" value="Sexta-feira">
                                                    <span>Sexta-feira</span>
                                                </label>
                                                <label class="checkbox-label">
                                                    <input type="checkbox" name="dias_aula[]" value="S√°bado">
                                                    <span>S√°bado</span>
                                                </label>
                                                <label class="checkbox-label">
                                                    <input type="checkbox" name="dias_aula[]" value="Domingo">
                                                    <span>Domingo</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <button type="button" class="btn btn-outline add-unidade-btn">+ Adicionar outra
                                        unidade</button>
                                </fieldset>
                            </div>

                            <!-- Subformul√°rio para Online -->
                            <div class="form-group full-width" id="plataforma_container" style="display:none;">
                                <fieldset class="unidade-fieldset">
                                    <legend>Informa√ß√µes da Plataforma <button type="button"
                                            class="remove-plataforma-btn" onclick="removePlataforma(this)"
                                            style="display:none;">√ó</button></legend>

                                    <!-- Container para plataforma online -->
                                    <div id="plataforma_list">
                                        <!-- Informa√ß√µes da plataforma online -->
                                        <div class="plataforma-item" data-plataforma="0">
                                            <label for="plataforma_digital">Plataforma Digital</label>
                                            <input type="text" id="plataforma_digital" name="plataforma_digital"
                                                placeholder="Ex: Zoom, Google Meet, Microsoft Teams">

                                            <label>Total de vagas*</label>
                                            <input type="number" id="vagas_online" name="vagas_unidade[]" min="1"
                                                required>

                                            <label for="carga_horaria_online" class="required">Carga Hor√°ria</label>
                                            <input type="text" id="carga_horaria_online" name="carga_horaria" required
                                                placeholder="Digite a carga hor√°ria (ex: 40 horas, 80h, 2 meses, etc.)">
                                            <small
                                                style="color: red; font-size: 0.9em; margin-top: 5px; display: block;">(D√™
                                                prefer√™ncia a carga hor√°ria no formato de horas)</small>

                                            <label class="required">Aulas Ass√≠ncronas?</label>
                                            <div class="radio-group">
                                                <label class="radio-label">
                                                    <input type="radio" name="aulas_assincronas" value="sim" required
                                                        checked onclick="toggleAulasAssincronas(true)"> SIM
                                                </label>
                                                <label class="radio-label">
                                                    <input type="radio" name="aulas_assincronas" value="nao" required
                                                        onclick="toggleAulasAssincronas(false)"> N√ÉO
                                                </label>
                                            </div>

                                            <div class="data-group" id="horarios_online_container">
                                                <div class="data-field">
                                                    <label>In√≠cio das aulas</label>
                                                    <input type="date" id="inicio_aulas_online"
                                                        name="inicio_aulas_data[]" value="{{ today_date }}">
                                                </div>
                                                <div class="data-field">
                                                    <label>Fim das aulas</label>
                                                    <input type="date" id="fim_aulas_online" name="fim_aulas_data[]"
                                                        value="{{ today_date }}">
                                                </div>
                                            </div>
                                            <div id="horarios_detalhados_online_container" style="display: none;">
                                                <div class="horario-group">
                                                    <div class="horario-field">
                                                        <label>Hor√°rio-In√≠cio</label>
                                                        <select id="horario_inicio_online" name="horario_inicio[]">
                                                            <option value="">Selecione o hor√°rio</option>
                                                            <option value="06:00">06:00</option>
                                                            <option value="07:00">07:00</option>
                                                            <option value="08:00">08:00</option>
                                                            <option value="09:00">09:00</option>
                                                            <option value="10:00">10:00</option>
                                                            <option value="11:00">11:00</option>
                                                            <option value="12:00">12:00</option>
                                                            <option value="13:00">13:00</option>
                                                            <option value="14:00">14:00</option>
                                                            <option value="15:00">15:00</option>
                                                            <option value="16:00">16:00</option>
                                                            <option value="17:00">17:00</option>
                                                            <option value="18:00">18:00</option>
                                                            <option value="19:00">19:00</option>
                                                            <option value="20:00">20:00</option>
                                                            <option value="21:00">21:00</option>
                                                            <option value="22:00">22:00</option>
                                                            <option value="23:00">23:00</option>
                                                        </select>
                                                    </div>
                                                    <div class="horario-field">
                                                        <label>Hor√°rio-Fim</label>
                                                        <select id="horario_fim_online" name="horario_fim[]">
                                                            <option value="">Selecione o hor√°rio</option>
                                                            <option value="06:00">06:00</option>
                                                            <option value="07:00">07:00</option>
                                                            <option value="08:00">08:00</option>
                                                            <option value="09:00">09:00</option>
                                                            <option value="10:00">10:00</option>
                                                            <option value="11:00">11:00</option>
                                                            <option value="12:00">12:00</option>
                                                            <option value="13:00">13:00</option>
                                                            <option value="14:00">14:00</option>
                                                            <option value="15:00">15:00</option>
                                                            <option value="16:00">16:00</option>
                                                            <option value="17:00">17:00</option>
                                                            <option value="18:00">18:00</option>
                                                            <option value="19:00">19:00</option>
                                                            <option value="20:00">20:00</option>
                                                            <option value="21:00">21:00</option>
                                                            <option value="22:00">22:00</option>
                                                            <option value="23:00">23:00</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <label>Dias de aula</label>
                                                <div class="checkbox-group dias-aula">
                                                    <label class="checkbox-label">
                                                        <input type="checkbox" name="dias_aula[]" value="Segunda-feira">
                                                        <span>Segunda-feira</span>
                                                    </label>
                                                    <label class="checkbox-label">
                                                        <input type="checkbox" name="dias_aula[]" value="Ter√ßa-feira">
                                                        <span>Ter√ßa-feira</span>
                                                    </label>
                                                    <label class="checkbox-label">
                                                        <input type="checkbox" name="dias_aula[]" value="Quarta-feira">
                                                        <span>Quarta-feira</span>
                                                    </label>
                                                    <label class="checkbox-label">
                                                        <input type="checkbox" name="dias_aula[]" value="Quinta-feira">
                                                        <span>Quinta-feira</span>
                                                    </label>
                                                    <label class="checkbox-label">
                                                        <input type="checkbox" name="dias_aula[]" value="Sexta-feira">
                                                        <span>Sexta-feira</span>
                                                    </label>
                                                    <label class="checkbox-label">
                                                        <input type="checkbox" name="dias_aula[]" value="S√°bado">
                                                        <span>S√°bado</span>
                                                    </label>
                                                    <label class="checkbox-label">
                                                        <input type="checkbox" name="dias_aula[]" value="Domingo">
                                                        <span>Domingo</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <button type="button" class="btn btn-outline add-plataforma-btn">+ Adicionar outra
                                        plataforma</button>
                                </fieldset>
                            </div>

                            <div class="form-group full-width">
                                <label for="acessibilidade" class="required">Acessibilidade</label>
                                <select id="acessibilidade" name="acessibilidade" required
                                    onchange="toggleRecursosAcessibilidade()" autocomplete="off">
                                    <option value="">Selecione uma op√ß√£o</option>
                                    <option value="acessivel">Acess√≠vel para pessoas com defici√™ncia</option>
                                    <option value="exclusivo">Exclusivo para pessoas com defici√™ncia</option>
                                    <option value="nao_acessivel">N√£o acess√≠vel para Pessoas com Defici√™ncia</option>
                                </select>
                            </div>

                            <div class="form-group full-width" id="recursos_acessibilidade_container"
                                style="display: none;">
                                <label for="recursos_acessibilidade" class="required">Recursos de Acessibilidade</label>
                                <textarea id="recursos_acessibilidade" name="recursos_acessibilidade" rows="3"
                                    placeholder="Ex: Int√©rprete de Libras, material em Braille, rampa de acesso, elevador..."></textarea>
                            </div>

                            <div class="form-group full-width">
                                <label for="publico_alvo" class="required">P√∫blico-alvo</label>
                                <textarea id="publico_alvo" name="publico_alvo" required rows="3"
                                    placeholder="Ex: Servidores p√∫blicos, estudantes, profissionais da √°rea de tecnologia..."></textarea>
                            </div>

                            <div class="form-group full-width">
                                <label class="required">O curso √© gratuito?</label>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="curso_gratuito" value="sim" required
                                            onclick="toggleValorCurso(false)" {% if duplicate_data and
                                            duplicate_data.curso_gratuito=='sim' %}checked{% endif %}> SIM
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="curso_gratuito" value="nao" required
                                            onclick="toggleValorCurso(true)" {% if duplicate_data and
                                            duplicate_data.curso_gratuito=='nao' %}checked{% endif %}> N√ÉO
                                    </label>
                                </div>
                            </div>

                            <div class="form-group full-width" id="valor_curso_container" style="display: none;">
                                <div class="valor-curso-row">
                                    <div class="valor-curso-col">
                                        <label for="valor_curso_inteira" class="required">Valor INTEIRA (R$)</label>
                                        <input type="text" id="valor_curso_inteira" name="valor_curso_inteira"
                                            step="0.01" min="0" placeholder="Digite o valor integral (ex: 100,00)"
                                            oninput="formatarValor(this)">
                                    </div>
                                    <div class="valor-curso-col">
                                        <label for="valor_curso_meia">Valor MEIA (R$)</label>
                                        <input type="text" id="valor_curso_meia" name="valor_curso_meia" step="0.01"
                                            min="0" placeholder="Digite o valor da meia (ex: 50,00)"
                                            oninput="formatarValor(this); toggleRequisitos()">
                                    </div>
                                </div>
                                <div id="requisitos_meia_container" style="display: none;">
                                    <label for="requisitos_meia" class="required">Condi√ß√µes para obten√ß√£o de
                                        meia-entrada</label>
                                    <textarea id="requisitos_meia" name="requisitos_meia" rows="2" required
                                        placeholder="Ex: Estudantes, idosos, pessoas com defici√™ncia..."></textarea>
                                </div>
                            </div>

                            <div class="form-group full-width">
                                <label class="required">Oferece Certificado</label>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="oferece_certificado" value="sim" required
                                            onclick="togglePreRequisitos(true)"> SIM
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="oferece_certificado" value="nao" required
                                            onclick="togglePreRequisitos(false)"> N√ÉO
                                    </label>
                                </div>
                            </div>

                            <div class="form-group full-width" id="pre_requisitos_container" style="display: none;">
                                <label for="pre_requisitos" class="required">Pr√©-requisitos para Recebimento de
                                    Certificados</label>
                                <textarea id="pre_requisitos" name="pre_requisitos" rows="3"
                                    placeholder="Ex: Frequ√™ncia m√≠nima de 75%, entrega de trabalho final, aprova√ß√£o em avalia√ß√£o..."></textarea>
                            </div>

                            <div class="form-group full-width">
                                <label class="required">Oferece Bolsa</label>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="oferece_bolsa" value="sim" required
                                            onclick="toggleValorBolsa(true)"> SIM
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="oferece_bolsa" value="nao" required
                                            onclick="toggleValorBolsa(false)"> N√ÉO
                                    </label>
                                </div>
                            </div>

                            <div class="form-group full-width" id="valor_bolsa_container" style="display: none;">
                                <label for="valor_bolsa" class="required">Valor da Bolsa (R$)</label>
                                <input type="text" id="valor_bolsa" name="valor_bolsa" step="0.01" min="0"
                                    placeholder="Digite o valor da bolsa (ex: 100,00)" oninput="formatarValor(this)">
                            </div>

                            <div class="form-group full-width" id="requisitos_bolsa_container" style="display: none;">
                                <label for="requisitos_bolsa" class="required">Requisitos para a Obten√ß√£o da
                                    Bolsa</label>
                                <textarea id="requisitos_bolsa" name="requisitos_bolsa" rows="3"
                                    placeholder="Descreva os requisitos necess√°rios para obten√ß√£o da bolsa"></textarea>
                            </div>

                            <div class="form-group full-width">
                                <label for="info_complementares">Informa√ß√µes Complementares para inscri√ß√£o de
                                    participantes</label>
                                <span style="color:red; font-size:0.9em; display:block; margin:4px 0 8px;">OBS: Com o
                                    acesso via gov.br, j√° teremos o Nome e CPF do candidato.</span>
                                <textarea id="info_complementares" name="info_complementares" rows="4"
                                    placeholder="Informe quais dados ser√£o necess√°rios para inscri√ß√£o dos participantes (Ex: Escolaridade, Idade, Bairro, etc.)"></textarea>
                            </div>

                            <!-- Pergunta: Informa√ß√µes adicionais do curso? -->
                            <div class="form-group full-width">
                                <label class="required">Informa√ß√µes adicionais do curso?</label>
                                <span style="color:red; font-size: 0.9em; display:block; margin:4px 0 8px;">Para
                                    divulgar o curso de forma clara e objetiva, o foco deve ser em apresentar somente as
                                    informa√ß√µes mais importantes. Detalhes adicionais podem ser comunicados aos alunos
                                    que se matricularem, por isso, avalie se esses dados s√£o realmente essenciais para o
                                    p√∫blico geral no momento da divulga√ß√£o.</span>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="info_adicionais_opcao" value="sim" required
                                            onclick="toggleInfoAdicionais(true)"> SIM
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="info_adicionais_opcao" value="nao" required
                                            onclick="toggleInfoAdicionais(false)"> N√ÉO
                                    </label>
                                </div>
                            </div>

                            <div class="form-group full-width" id="info_adicionais_container" style="display:none;">
                                <label for="info_adicionais" class="required">Informa√ß√µes Adicionais do Curso</label>
                                <textarea id="info_adicionais" name="info_complementares" rows="4"
                                    placeholder="Digite informa√ß√µes adicionais, como recursos utilizados, facilitador, etc"></textarea>
                            </div>

                            <!-- Parceiro Externo -->
                            <div class="form-group full-width">
                                <label class="required">CURSO OFERECIDO POR PARCEIRO EXTERNO?</label>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="parceiro_externo" value="sim" required
                                            onclick="toggleParceiroExterno(true)"> SIM
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="parceiro_externo" value="nao" required
                                            onclick="toggleParceiroExterno(false)"> N√ÉO
                                    </label>
                                </div>
                            </div>

                            <div class="form-group full-width" id="parceiro_externo_container" style="display:none;">
                                <fieldset class="unidade-fieldset">
                                    <legend>Informa√ß√µes do Parceiro</legend>

                                    <div class="parceiro-grid">
                                        <div class="parceiro-item">
                                            <label for="parceiro_nome" class="required">Nome do Parceiro</label>
                                            <input type="text" id="parceiro_nome" name="parceiro_nome"
                                                placeholder="Ex: Funda√ß√£o Exemplo">
                                        </div>

                                        <div class="parceiro-item">
                                            <label for="parceiro_logo">Logo do Parceiro</label>
                                            <input type="file" id="parceiro_logo" name="parceiro_logo"
                                                accept=".png,.jpg,.jpeg,image/*">
                                            <small class="file-hint">Formatos aceitos: PNG, JPG, JPEG</small>
                                        </div>

                                        <div class="parceiro-item full-width">
                                            <label for="parceiro_link">Link do Parceiro</label>
                                            <input type="text" id="parceiro_link" name="parceiro_link"
                                                placeholder="https://exemplo.org">
                                            <small class="help-text-red">Link da p√°gina web para onde o usu√°rio ser√°
                                                redirecionado para fins de inscri√ß√£o na plataforma do parceiro</small>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                        </div>
                    </div>

                    <!-- Bot√µes de A√ß√£o -->
                    <div class="form-actions">
                        <a href="{{ url_for('admin_login') }}" class="btn btn-secondary">
                            <i class="fas fa-user-shield"></i> Acesso do Admin
                        </a>
                        <button type="reset" class="btn btn-outline">
                            <i class="fas fa-undo"></i> Limpar Formul√°rio
                        </button>
                        <button type="submit" class="btn btn-primary" id="submitBtn">
                            <i class="fas fa-save"></i> Criar Curso
                        </button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <script>
        function toggleValorCurso(mostrar) {
            const valorCursoContainer = document.getElementById('valor_curso_container');
            const valorCursoInteira = document.getElementById('valor_curso_inteira');
            const valorCursoMeia = document.getElementById('valor_curso_meia');

            if (mostrar) {
                valorCursoContainer.style.display = 'block';
                if (valorCursoInteira) valorCursoInteira.setAttribute('required', 'required');
                if (valorCursoMeia) valorCursoMeia.setAttribute('required', 'required');
            } else {
                valorCursoContainer.style.display = 'none';
                if (valorCursoInteira) {
                    valorCursoInteira.removeAttribute('required');
                    valorCursoInteira.value = '';
                }
                if (valorCursoMeia) {
                    valorCursoMeia.removeAttribute('required');
                    valorCursoMeia.value = '';
                }
                // Esconder tamb√©m o campo de requisitos da meia quando curso for gratuito
                const requisitosContainer = document.getElementById('requisitos_meia_container');
                const requisitosField = document.getElementById('requisitos_meia');
                if (requisitosContainer) requisitosContainer.style.display = 'none';
                if (requisitosField) {
                    requisitosField.removeAttribute('required');
                    requisitosField.value = '';
                }
            }
        }

        function toggleRequisitos() {
            const valorMeia = document.getElementById('valor_curso_meia');
            const requisitosContainer = document.getElementById('requisitos_meia_container');
            const requisitosField = document.getElementById('requisitos_meia');

            if (valorMeia && requisitosContainer && requisitosField) {
                const valor = valorMeia.value.trim();

                if (valor !== '') {
                    // Se h√° valor na meia, mostrar campo de requisitos
                    requisitosContainer.style.display = 'block';
                    requisitosField.setAttribute('required', 'required');
                } else {
                    // Se n√£o h√° valor na meia, esconder campo de requisitos
                    requisitosContainer.style.display = 'none';
                    requisitosField.removeAttribute('required');
                    requisitosField.value = '';
                }
            }
        }

        function formatarValor(input) {
            // Remove tudo que n√£o √© n√∫mero ou v√≠rgula
            let valor = input.value.replace(/[^\d,]/g, '');

            // Se h√° v√≠rgula, garante que s√≥ h√° uma
            const partes = valor.split(',');
            if (partes.length > 2) {
                valor = partes[0] + ',' + partes.slice(1).join('');
            }

            // Limita a 2 casas decimais ap√≥s a v√≠rgula
            if (partes.length === 2 && partes[1].length > 2) {
                valor = partes[0] + ',' + partes[1].substring(0, 2);
            }

            input.value = valor;
        }

        function togglePreRequisitos(mostrar) {
            const preRequisitosContainer = document.getElementById('pre_requisitos_container');
            if (mostrar) {
                preRequisitosContainer.style.display = 'block';
                document.getElementById('pre_requisitos').setAttribute('required', 'required');
            } else {
                preRequisitosContainer.style.display = 'none';
                document.getElementById('pre_requisitos').removeAttribute('required');
                document.getElementById('pre_requisitos').value = '';
            }
        }

        function toggleRecursosAcessibilidade() {
            const acessibilidadeSelect = document.getElementById('acessibilidade');
            const recursosContainer = document.getElementById('recursos_acessibilidade_container');
            const recursosField = document.getElementById('recursos_acessibilidade');

            if (acessibilidadeSelect.value === 'acessivel' || acessibilidadeSelect.value === 'exclusivo') {
                recursosContainer.style.display = 'block';
                recursosField.setAttribute('required', 'required');
            } else {
                recursosContainer.style.display = 'none';
                recursosField.removeAttribute('required');
                recursosField.value = '';
            }
        }

        function toggleValorBolsa(mostrar) {
            const valorBolsaContainer = document.getElementById('valor_bolsa_container');
            const requisitosContainer = document.getElementById('requisitos_bolsa_container');

            if (mostrar) {
                valorBolsaContainer.style.display = 'block';
                requisitosContainer.style.display = 'block';
                document.getElementById('valor_bolsa').setAttribute('required', 'required');
                document.getElementById('requisitos_bolsa').setAttribute('required', 'required');
            } else {
                valorBolsaContainer.style.display = 'none';
                requisitosContainer.style.display = 'none';
                document.getElementById('valor_bolsa').removeAttribute('required');
                document.getElementById('requisitos_bolsa').removeAttribute('required');
                document.getElementById('valor_bolsa').value = '';
                document.getElementById('requisitos_bolsa').value = '';
            }
        }

        function toggleParceiroExterno(mostrar) {
            const container = document.getElementById('parceiro_externo_container');
            const nome = document.getElementById('parceiro_nome');
            const logo = document.getElementById('parceiro_logo');
            const link = document.getElementById('parceiro_link');

            if (mostrar) {
                container.style.display = 'block';
                nome.setAttribute('required', 'required');
            } else {
                container.style.display = 'none';
                nome.removeAttribute('required');
                if (logo) logo.value = '';
                if (link) link.value = '';
            }
        }

        // Valida√ß√£o do campo de link do parceiro
        function validatePartnerLink() {
            const linkField = document.getElementById('parceiro_link');
            if (linkField && linkField.value.trim() !== '') {
                const url = linkField.value.trim();
                // Verificar se √© uma URL v√°lida
                try {
                    new URL(url);
                    linkField.setCustomValidity('');
                } catch (e) {
                    linkField.setCustomValidity('Por favor, insira uma URL v√°lida (ex: https://exemplo.org)');
                }
            } else {
                if (linkField) linkField.setCustomValidity('');
            }
        }

        // Valida√ß√£o dos dias de aula (pelo menos um deve ser selecionado)
        function validateDiasAula() {
            const diasCheckboxes = document.querySelectorAll('input[name="dias_aula[]"]');
            const unidadesContainer = document.getElementById('unidades_container');

            if (unidadesContainer && unidadesContainer.style.display !== 'none') {
                const algumSelecionado = Array.from(diasCheckboxes).some(cb => cb.checked);

                diasCheckboxes.forEach(cb => {
                    if (!algumSelecionado) {
                        cb.setCustomValidity('Selecione pelo menos um dia da semana');
                    } else {
                        cb.setCustomValidity('');
                    }
                });
            }
        }

        // Fun√ß√£o para gerenciar upload de capa do curso
        function setupCourseCoverUpload() {
            const fileInput = document.getElementById('capa_curso');
            const fileDisplay = document.querySelector('.file-upload-display');
            const fileText = document.querySelector('.file-upload-text');

            if (fileInput && fileDisplay && fileText) {
                fileInput.addEventListener('change', function (e) {
                    const file = e.target.files[0];
                    if (file) {
                        // Validar formato do arquivo
                        const allowedTypes = ['image/jpeg', 'image/png', 'image/jpg', 'image/bmp'];
                        if (!allowedTypes.includes(file.type)) {
                            alert('Formato de arquivo n√£o suportado. Use JPEG, PNG, JPG ou BMP.');
                            fileInput.value = '';
                            return;
                        }

                        // Validar tamanho do arquivo (m√°ximo 5MB)
                        const maxSize = 5 * 1024 * 1024; // 5MB
                        if (file.size > maxSize) {
                            alert('Arquivo muito grande. Tamanho m√°ximo: 5MB');
                            fileInput.value = '';
                            return;
                        }

                        // Atualizar display
                        fileDisplay.classList.add('has-file');
                        fileText.textContent = `Arquivo selecionado: ${file.name}`;

                        // Mostrar preview da imagem
                        const reader = new FileReader();
                        reader.onload = function (e) {
                            // Remover preview anterior se existir
                            const existingPreview = fileDisplay.querySelector('.image-preview');
                            if (existingPreview) {
                                existingPreview.remove();
                            }

                            // Criar preview
                            const preview = document.createElement('img');
                            preview.className = 'image-preview';
                            preview.src = e.target.result;
                            preview.style.maxWidth = '200px';
                            preview.style.maxHeight = '150px';
                            preview.style.borderRadius = '4px';
                            preview.style.marginTop = '10px';
                            preview.style.objectFit = 'cover';

                            fileDisplay.appendChild(preview);
                        };
                        reader.readAsDataURL(file);
                    } else {
                        // Remover estado de arquivo selecionado
                        fileDisplay.classList.remove('has-file');
                        fileText.textContent = 'Clique para selecionar uma imagem';

                        // Remover preview
                        const existingPreview = fileDisplay.querySelector('.image-preview');
                        if (existingPreview) {
                            existingPreview.remove();
                        }
                    }
                });
            }
        }

        // Adicionar valida√ß√£o quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', function () {
            const linkField = document.getElementById('parceiro_link');
            if (linkField) {
                linkField.addEventListener('blur', validatePartnerLink);
                linkField.addEventListener('input', validatePartnerLink);
            }

            // Configurar upload de capa do curso
            setupCourseCoverUpload();

            // Adicionar valida√ß√£o aos checkboxes de dias
            const diasCheckboxes = document.querySelectorAll('input[name="dias_aula[]"]');
            diasCheckboxes.forEach(cb => {
                cb.addEventListener('change', validateDiasAula);
            });

            // Scroll autom√°tico para mensagens de erro
            const errorAlert = document.querySelector('.alert-error');
            if (errorAlert) {
                errorAlert.scrollIntoView({ behavior: 'smooth', block: 'center' });

                // Destacar a mensagem de erro
                setTimeout(() => {
                    errorAlert.style.transform = 'scale(1.02)';
                    setTimeout(() => {
                        errorAlert.style.transform = 'scale(1)';
                    }, 200);
                }, 100);
            }
        });
    </script>

    <script>
        function togglePreRequisitos(mostrar) {
            const container = document.getElementById('pre_requisitos_container');
            const preRequisitosField = document.getElementById('pre_requisitos');

            if (mostrar) {
                container.style.display = 'block';
                preRequisitosField.setAttribute('required', '');
            } else {
                container.style.display = 'none';
                preRequisitosField.removeAttribute('required');
                preRequisitosField.value = '';
            }
        }

        function toggleUnidades() {
            const modalidade = document.getElementById('modalidade').value;
            const unidadesContainer = document.getElementById('unidades_container');
            const plataformaContainer = document.getElementById('plataforma_container');

            // Ocultar ambos os containers primeiro
            unidadesContainer.style.display = 'none';
            plataformaContainer.style.display = 'none';

            if (modalidade === 'Presencial' || modalidade === 'H√≠brido') {
                // Mostrar subformul√°rio "Informa√ß√µes da Unidade"
                unidadesContainer.style.display = 'block';
                setUnidadeFieldsRequired(true);
                setPlataformaFieldsRequired(false);
            } else if (modalidade === 'Online') {
                // Mostrar subformul√°rio "Informa√ß√µes da Plataforma"
                plataformaContainer.style.display = 'block';
                setUnidadeFieldsRequired(false);
                setPlataformaFieldsRequired(true);
            } else {
                // Modalidade n√£o selecionada
                setUnidadeFieldsRequired(false);
                setPlataformaFieldsRequired(false);
            }
        }

        function setUnidadeFieldsRequired(required) {
            // Selecionar todos os campos de unidade diretamente
            const camposUnidade = document.querySelectorAll(
                'input[name="endereco_unidade[]"], ' +
                'input[name="bairro_unidade[]"], ' +
                'input[name="vagas_unidade[]"], ' +
                'input[name="inicio_aulas_data[]"], ' +
                'input[name="fim_aulas_data[]"], ' +
                'select[name="horario_inicio[]"], ' +
                'select[name="horario_fim[]"]'
            );

            const cargaHorariaUnidade = document.getElementById('carga_horaria_unidade');

            // Processar campos de unidade
            camposUnidade.forEach(campo => {
                if (required) {
                    campo.setAttribute('required', 'required');
                } else {
                    campo.removeAttribute('required');
                }
            });

            // Controlar campo Carga Hor√°ria do subformul√°rio Unidade
            if (cargaHorariaUnidade) {
                if (required) {
                    cargaHorariaUnidade.setAttribute('required', 'required');
                } else {
                    cargaHorariaUnidade.removeAttribute('required');
                    // S√≥ limpar se o campo estiver vazio
                    if (cargaHorariaUnidade.value === '') {
                        cargaHorariaUnidade.value = '';
                    }
                }
            }
        }

        function setPlataformaFieldsRequired(required) {
            const plataformaDigital = document.getElementById('plataforma_digital');
            const vagasOnline = document.getElementById('vagas_online');
            const cargaHorariaOnline = document.getElementById('carga_horaria_online');
            const inicioAulasOnline = document.getElementById('inicio_aulas_online');
            const fimAulasOnline = document.getElementById('fim_aulas_online');
            const horarioInicioOnline = document.getElementById('horario_inicio_online');
            const horarioFimOnline = document.getElementById('horario_fim_online');

            // Verificar se aulas ass√≠ncronas est√° marcado como "SIM"
            const aulasAssincronasSim = document.querySelector('input[name="aulas_assincronas"][value="sim"]');
            const isAsync = aulasAssincronasSim && aulasAssincronasSim.checked;

            // Campos sempre obrigat√≥rios para modalidade Online
            const camposObrigatorios = [plataformaDigital, vagasOnline, cargaHorariaOnline];

            // Campos condicionais (s√≥ obrigat√≥rios se n√£o for ass√≠ncrono)
            const camposCondicionais = [inicioAulasOnline, fimAulasOnline, horarioInicioOnline, horarioFimOnline];

            // Processar campos obrigat√≥rios
            camposObrigatorios.forEach(campo => {
                if (campo) {
                    if (required) {
                        campo.setAttribute('required', 'required');
                    } else {
                        campo.removeAttribute('required');
                        if (campo.value === '' || campo.id !== 'carga_horaria_online') {
                            campo.value = '';
                        }
                    }
                }
            });

            // Processar campos condicionais
            camposCondicionais.forEach(campo => {
                if (campo) {
                    if (required && !isAsync) {
                        // Aulas s√≠ncronas - campos obrigat√≥rios
                        campo.setAttribute('required', 'required');
                    } else {
                        // Aulas ass√≠ncronas ou n√£o obrigat√≥rios - remover required mas N√ÉO limpar valores
                        campo.removeAttribute('required');
                        // N√ÉO limpar o valor do campo - deixar como est√°
                    }
                }
            });
        }

        // Fun√ß√£o addUnidade removida - agora delegada para FormManager

        function removeUnidade(button) {
            const unidadesList = document.getElementById('unidades_list');
            const unidades = unidadesList.querySelectorAll('.unidade-item');

            // N√£o permitir remover se s√≥ h√° uma unidade
            if (unidades.length <= 1) {
                return;
            }

            // Remover a unidade
            const unidadeItem = button.closest('.unidade-item');
            unidadeItem.remove();

            // Renumerar as unidades restantes
            renumberUnits();
            updateRemoveButtonsVisibility();
        }

        function renumberUnits() {
            const unidades = document.querySelectorAll('#unidades_list .unidade-item');
            unidades.forEach((unidade, index) => {
                unidade.setAttribute('data-unidade', index);
                const legend = unidade.querySelector('legend');
                if (legend) {
                    legend.innerHTML = `Informa√ß√µes da Unidade ${index + 1} <button type="button" class="remove-unidade-btn" onclick="removeUnidade(this)">√ó</button>`;
                }
            });
        }

        function updateRemoveButtonsVisibility() {
            const unidades = document.querySelectorAll('#unidades_list .unidade-item');
            const removeButtons = document.querySelectorAll('.remove-unidade-btn');

            // Mostrar bot√£o de remover apenas se h√° mais de uma unidade
            removeButtons.forEach(button => {
                button.style.display = unidades.length > 1 ? 'inline-block' : 'none';
            });
        }

        // Fun√ß√µes para gerenciar plataformas online
        function addPlataforma() {
            const plataformaList = document.getElementById('plataforma_list');
            const plataformas = plataformaList.querySelectorAll('.unidade-item');
            const nextIndex = plataformas.length;

            // Criar nova plataforma
            const newPlataforma = document.createElement('div');
            newPlataforma.className = 'unidade-item';
            newPlataforma.setAttribute('data-plataforma', nextIndex);

            newPlataforma.innerHTML = `
                <legend>Informa√ß√µes da Plataforma ${nextIndex + 1} <button type="button" class="remove-plataforma-btn" onclick="removePlataforma(this)">√ó</button></legend>
                <label for="plataforma_digital_${nextIndex}">Plataforma Digital</label>
                <input type="text" id="plataforma_digital_${nextIndex}" name="plataforma_digital" 
                       placeholder="Ex: Zoom, Google Meet, Microsoft Teams">
                
                <label>Total de vagas*</label>
                <input type="number" name="vagas_unidade[]" min="1" required>
                
                <label for="carga_horaria_online_${nextIndex}" class="required">Carga Hor√°ria</label>
                <input type="text" id="carga_horaria_online_${nextIndex}" name="carga_horaria" required 
                       placeholder="Digite a carga hor√°ria (ex: 40 horas, 80h, 2 meses, etc.)">
                <small style="color: red; font-size: 0.9em; margin-top: 5px; display: block;">(D√™ prefer√™ncia a carga hor√°ria no formato de horas)</small>
                
                <label class="required">Aulas Ass√≠ncronas?</label>
                <div class="radio-group">
                    <label class="radio-label">
                        <input type="radio" name="aulas_assincronas" value="sim" required checked onclick="toggleAulasAssincronas(true)"> SIM
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="aulas_assincronas" value="nao" required onclick="toggleAulasAssincronas(false)"> N√ÉO
                    </label>
                </div>
                
                <div class="data-group" id="horarios_online_container_${nextIndex}">
                    <div class="data-field">
                        <label>In√≠cio das aulas</label>
                        <input type="date" name="inicio_aulas_data[]" value="{{ today_date }}">
                    </div>
                    <div class="data-field">
                        <label>Fim das aulas</label>
                        <input type="date" name="fim_aulas_data[]" value="{{ today_date }}">
                    </div>
                </div>
                <div class="horario-group">
                    <div class="horario-field">
                        <label>Hor√°rio-In√≠cio</label>
                        <select name="horario_inicio[]">
                            <option value="">Selecione o hor√°rio</option>
                            <option value="06:00">06:00</option>
                            <option value="07:00">07:00</option>
                            <option value="08:00">08:00</option>
                            <option value="09:00">09:00</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="12:00">12:00</option>
                            <option value="13:00">13:00</option>
                            <option value="14:00">14:00</option>
                            <option value="15:00">15:00</option>
                            <option value="16:00">16:00</option>
                            <option value="17:00">17:00</option>
                            <option value="18:00">18:00</option>
                            <option value="19:00">19:00</option>
                            <option value="20:00">20:00</option>
                            <option value="21:00">21:00</option>
                            <option value="22:00">22:00</option>
                        </select>
                    </div>
                    <div class="horario-field">
                        <label>Hor√°rio-Fim</label>
                        <select name="horario_fim[]">
                            <option value="">Selecione o hor√°rio</option>
                            <option value="06:00">06:00</option>
                            <option value="07:00">07:00</option>
                            <option value="08:00">08:00</option>
                            <option value="09:00">09:00</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="12:00">12:00</option>
                            <option value="13:00">13:00</option>
                            <option value="14:00">14:00</option>
                            <option value="15:00">15:00</option>
                            <option value="16:00">16:00</option>
                            <option value="17:00">17:00</option>
                            <option value="18:00">18:00</option>
                            <option value="19:00">19:00</option>
                            <option value="20:00">20:00</option>
                            <option value="21:00">21:00</option>
                            <option value="22:00">22:00</option>
                        </select>
                    </div>
                </div>
                <label>Dias de aula</label>
                <div class="checkbox-group dias-aula">
                    <label class="checkbox-label">
                        <input type="checkbox" name="dias_aula[]" value="Segunda-feira">
                        <span>Segunda-feira</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="dias_aula[]" value="Ter√ßa-feira">
                        <span>Ter√ßa-feira</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="dias_aula[]" value="Quarta-feira">
                        <span>Quarta-feira</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="dias_aula[]" value="Quinta-feira">
                        <span>Quinta-feira</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="dias_aula[]" value="Sexta-feira">
                        <span>Sexta-feira</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="dias_aula[]" value="S√°bado">
                        <span>S√°bado</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="dias_aula[]" value="Domingo">
                        <span>Domingo</span>
                    </label>
                </div>
            `;

            plataformaList.appendChild(newPlataforma);
            updateRemovePlataformaButtonsVisibility();
        }

        function removePlataforma(button) {
            const plataformaList = document.getElementById('plataforma_list');
            const plataformas = plataformaList.querySelectorAll('.unidade-item');

            // N√£o permitir remover se s√≥ h√° uma plataforma
            if (plataformas.length <= 1) {
                return;
            }

            // Remover a plataforma
            const plataformaItem = button.closest('.unidade-item');
            plataformaItem.remove();

            // Renumerar as plataformas restantes
            renumberPlataformas();
            updateRemovePlataformaButtonsVisibility();
        }

        function renumberPlataformas() {
            const plataformas = document.querySelectorAll('#plataforma_list .unidade-item');
            plataformas.forEach((plataforma, index) => {
                plataforma.setAttribute('data-plataforma', index);
                const legend = plataforma.querySelector('legend');
                if (legend) {
                    legend.innerHTML = `Informa√ß√µes da Plataforma ${index + 1} <button type="button" class="remove-plataforma-btn" onclick="removePlataforma(this)">√ó</button>`;
                }
            });
        }

        function updateRemovePlataformaButtonsVisibility() {
            const plataformas = document.querySelectorAll('#plataforma_list .unidade-item');
            const removeButtons = document.querySelectorAll('.remove-plataforma-btn');

            // Mostrar bot√£o de remover apenas se h√° mais de uma plataforma
            removeButtons.forEach(button => {
                button.style.display = plataformas.length > 1 ? 'inline-block' : 'none';
            });
        }

        function toggleAulasAssincronas(isAssincronas) {
            const horariosContainer = document.getElementById('horarios_detalhados_online_container');
            const horariosOnlineContainer = document.getElementById('horarios_online_container');

            console.log('toggleAulasAssincronas chamada com isAssincronas:', isAssincronas);
            console.log('horariosContainer encontrado:', !!horariosContainer);
            console.log('horariosOnlineContainer encontrado:', !!horariosOnlineContainer);

            if (horariosContainer && horariosOnlineContainer) {
                if (isAssincronas) {
                    // Aulas ass√≠ncronas - ocultar campos de hor√°rio e dias
                    horariosContainer.style.display = 'none';
                    horariosOnlineContainer.style.display = 'none';
                    console.log('Campos ocultos para aulas ass√≠ncronas');

                    // Remover required dos campos ocultos
                    const camposHorario = [
                        document.getElementById('horario_inicio_online'),
                        document.getElementById('horario_fim_online')
                    ];
                    const camposDias = horariosOnlineContainer.querySelectorAll('input[name="dias_aula[]"]');

                    camposHorario.forEach(campo => {
                        if (campo) campo.removeAttribute('required');
                    });
                    camposDias.forEach(campo => {
                        if (campo) campo.removeAttribute('required');
                    });
                } else {
                    // Aulas s√≠ncronas - mostrar campos de hor√°rio e dias
                    horariosContainer.style.display = 'block';
                    horariosOnlineContainer.style.display = 'block';
                    console.log('Campos mostrados para aulas s√≠ncronas');
                    console.log('horariosContainer.style.display:', horariosContainer.style.display);
                    console.log('horariosOnlineContainer.style.display:', horariosOnlineContainer.style.display);

                    // Adicionar required aos campos vis√≠veis
                    const camposHorario = [
                        document.getElementById('horario_inicio_online'),
                        document.getElementById('horario_fim_online')
                    ];
                    const camposDias = horariosOnlineContainer.querySelectorAll('input[name="dias_aula[]"]');

                    camposHorario.forEach(campo => {
                        if (campo) {
                            campo.setAttribute('required', 'required');
                            console.log('Campo marcado como required:', campo.name, campo.value);
                        }
                    });
                    camposDias.forEach(campo => {
                        if (campo) campo.setAttribute('required', 'required');
                    });
                }
            }
        }

        // Fun√ß√£o para garantir que campos ass√≠ncronos estejam corretos
        function garantirCamposAssincronos() {
            const aulasAssincronasSim = document.querySelector('input[name="aulas_assincronas"][value="sim"]');
            const aulasAssincronasNao = document.querySelector('input[name="aulas_assincronas"][value="nao"]');
            const horarioInicioOnline = document.getElementById('horario_inicio_online');
            const horarioFimOnline = document.getElementById('horario_fim_online');

            console.log('garantirCamposAssincronos chamada');
            console.log('aulasAssincronasSim checked:', aulasAssincronasSim ? aulasAssincronasSim.checked : 'n√£o encontrado');
            console.log('aulasAssincronasNao checked:', aulasAssincronasNao ? aulasAssincronasNao.checked : 'n√£o encontrado');

            if (aulasAssincronasSim && aulasAssincronasSim.checked) {
                // SIM est√° marcado - garantir que campos de hor√°rio n√£o sejam obrigat√≥rios
                if (horarioInicioOnline) horarioInicioOnline.removeAttribute('required');
                if (horarioFimOnline) horarioFimOnline.removeAttribute('required');

                // Garantir que containers estejam ocultos
                const horariosContainer = document.getElementById('horarios_detalhados_online_container');
                const horariosOnlineContainer = document.getElementById('horarios_online_container');
                if (horariosContainer) horariosContainer.style.display = 'none';
                if (horariosOnlineContainer) horariosOnlineContainer.style.display = 'none';
                console.log('Campos ocultos por garantirCamposAssincronos (SIM)');
            } else if (aulasAssincronasNao && aulasAssincronasNao.checked) {
                // N√ÉO est√° marcado - garantir que campos de hor√°rio sejam obrigat√≥rios e vis√≠veis
                if (horarioInicioOnline) horarioInicioOnline.setAttribute('required', 'required');
                if (horarioFimOnline) horarioFimOnline.setAttribute('required', 'required');

                // Garantir que containers estejam vis√≠veis
                const horariosContainer = document.getElementById('horarios_detalhados_online_container');
                const horariosOnlineContainer = document.getElementById('horarios_online_container');
                if (horariosContainer) horariosContainer.style.display = 'block';
                if (horariosOnlineContainer) horariosOnlineContainer.style.display = 'block';
                console.log('Campos mostrados por garantirCamposAssincronos (N√ÉO)');
                console.log('horariosContainer.style.display:', horariosContainer ? horariosContainer.style.display : 'n√£o encontrado');
                console.log('horariosOnlineContainer.style.display:', horariosOnlineContainer ? horariosOnlineContainer.style.display : 'n√£o encontrado');
            }
        }

        // Fun√ß√£o para verificar estado dos campos antes do envio
        function verificarEstadoCampos() {
            const aulasAssincronasNao = document.querySelector('input[name="aulas_assincronas"][value="nao"]');
            const horariosContainer = document.getElementById('horarios_detalhados_online_container');
            const horarioInicioOnline = document.getElementById('horario_inicio_online');
            const horarioFimOnline = document.getElementById('horario_fim_online');

            console.log('=== VERIFICA√á√ÉO ANTES DO ENVIO ===');
            console.log('aulas_assincronas = nao:', aulasAssincronasNao ? aulasAssincronasNao.checked : 'n√£o encontrado');
            console.log('horariosContainer encontrado:', !!horariosContainer);
            console.log('horariosContainer.style.display:', horariosContainer ? horariosContainer.style.display : 'n√£o encontrado');
            console.log('horarioInicioOnline encontrado:', !!horarioInicioOnline);
            console.log('horarioInicioOnline.value:', horarioInicioOnline ? horarioInicioOnline.value : 'n√£o encontrado');
            console.log('horarioFimOnline encontrado:', !!horarioFimOnline);
            console.log('horarioFimOnline.value:', horarioFimOnline ? horarioFimOnline.value : 'n√£o encontrado');

            // Verificar todos os campos de hor√°rio no formul√°rio
            const todosHorariosInicio = document.querySelectorAll('select[name="horario_inicio[]"]');
            const todosHorariosFim = document.querySelectorAll('select[name="horario_fim[]"]');

            console.log('=== TODOS OS CAMPOS DE HOR√ÅRIO ===');
            console.log('Total campos horario_inicio[]:', todosHorariosInicio.length);
            todosHorariosInicio.forEach((campo, index) => {
                console.log(`horario_inicio[${index}]:`, campo.value, 'vis√≠vel:', campo.offsetParent !== null);
            });

            console.log('Total campos horario_fim[]:', todosHorariosFim.length);
            todosHorariosFim.forEach((campo, index) => {
                console.log(`horario_fim[${index}]:`, campo.value, 'vis√≠vel:', campo.offsetParent !== null);
            });
            console.log('================================');
        }

        // Inicializar campos quando a p√°gina carrega
        document.addEventListener('DOMContentLoaded', function () {
            // Inicializar modalidade corretamente primeiro
            toggleUnidades();

            // Inicializar campos ass√≠ncronos apenas uma vez
            setTimeout(garantirCamposAssincronos, 100);

            // Monitorar mudan√ßas nos radio buttons de aulas ass√≠ncronas
            const radioButtons = document.querySelectorAll('input[name="aulas_assincronas"]');
            radioButtons.forEach(radio => {
                radio.addEventListener('change', function () {
                    // Garantir que campos estejam corretos independente da sele√ß√£o
                    setTimeout(garantirCamposAssincronos, 10);
                });
            });

            // Monitorar mudan√ßas na modalidade
            const modalidadeSelect = document.getElementById('modalidade');
            if (modalidadeSelect) {
                modalidadeSelect.addEventListener('change', function () {
                    if (this.value === 'Online') {
                        // Quando modalidade Online for selecionada, garantir campos ass√≠ncronos
                        setTimeout(garantirCamposAssincronos, 10);
                        // Configurar campos obrigat√≥rios da plataforma
                        setTimeout(() => setPlataformaFieldsRequired(true), 50);
                    }
                });
            }

            // Verificar estado dos campos antes do envio do formul√°rio
            const form = document.querySelector('form');
            if (form) {
                form.addEventListener('submit', function (e) {
                    verificarEstadoCampos();

                    // Verificar FormData antes do envio
                    const formData = new FormData(form);
                    console.log('=== FORMDATA ANTES DO ENVIO ===');
                    console.log('horario_inicio[]:', formData.getAll('horario_inicio[]'));
                    console.log('horario_fim[]:', formData.getAll('horario_fim[]'));
                    console.log('aulas_assincronas:', formData.get('aulas_assincronas'));
                    console.log('modalidade:', formData.get('modalidade'));
                    console.log('================================');

                    // Se campos de hor√°rio est√£o vazios mas deveriam estar preenchidos, for√ßar visibilidade
                    const aulasAssincronasNao = document.querySelector('input[name="aulas_assincronas"][value="nao"]');
                    if (aulasAssincronasNao && aulasAssincronasNao.checked) {
                        const horariosContainer = document.getElementById('horarios_detalhados_online_container');
                        if (horariosContainer && horariosContainer.style.display === 'none') {
                            console.log('‚ö†Ô∏è CORRE√á√ÉO: Container estava oculto, for√ßando visibilidade');
                            horariosContainer.style.display = 'block';
                        }
                    }
                });
            }
        });

    </script>

    <!-- Scripts JavaScript modulares -->
    <script src="{{ url_for('static', filename='js/loading-manager.js') }}"></script>
    <script src="{{ url_for('static', filename='js/form-validator.js') }}"></script>
    <script src="{{ url_for('static', filename='js/form-manager.js') }}"></script>
    <script src="{{ url_for('static', filename='js/image-resizer.js') }}"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>

    {% if duplicate_data %}
    <script>
        // JAVASCRIPT DE DUPLICA√á√ÉO DESABILITADO PARA TESTE
        // Script para pr√©-preencher campos na duplica√ß√£o
        document.addEventListener('DOMContentLoaded', function () {
            console.log('üîÑ JavaScript de duplica√ß√£o DESABILITADO para teste');

            // Dados de duplica√ß√£o do servidor
            const duplicateData = {{ duplicate_data | tojson | safe
        }};

        // DESABILITADO - Pr√©-preencher modalidade (sem disparar evento change que interfere com unidades)
        // if (duplicateData.modalidade) {
        //     const modalidadeSelect = document.getElementById('modalidade');
        //     if (modalidadeSelect) {
        //         modalidadeSelect.value = duplicateData.modalidade;
        //         // N√ÉO disparar evento change para n√£o interferir com unidades pr√©-renderizadas
        //         // modalidadeSelect.dispatchEvent(new Event('change'));
        //     }
        // }

        // Aguardar um pouco para os campos condicionais carregarem
        setTimeout(function () {
            // Pr√©-preencher campos espec√≠ficos da modalidade
            if (duplicateData.modalidade === 'presencial' || duplicateData.modalidade === 'hibrido') {
                preencherCamposPresencial(duplicateData);
            }

            if (duplicateData.modalidade === 'online' || duplicateData.modalidade === 'hibrido') {
                preencherCamposOnline(duplicateData);
            }

            // Pr√©-preencher campos comuns
            preencherCamposComuns(duplicateData);

            console.log('‚úÖ Dados de duplica√ß√£o carregados com sucesso');
        }, 500);
        });

        function preencherCamposPresencial(data) {
            // Pr√©-preencher localidades se existirem
            if (data.nome_unidade) {
                const unidades = data.nome_unidade.split('|');
                const enderecos = data.endereco_unidade ? data.endereco_unidade.split('|') : [];
                const bairros = data.bairro_unidade ? data.bairro_unidade.split('|') : [];
                const vagas = data.vagas_unidade ? data.vagas_unidade.split('|') : [];
                const inicioAulas = data.inicio_aulas_data ? data.inicio_aulas_data.split('|') : [];
                const fimAulas = data.fim_aulas_data ? data.fim_aulas_data.split('|') : [];
                const horarioInicio = data.horario_inicio ? data.horario_inicio.split('|') : [];
                const horarioFim = data.horario_fim ? data.horario_fim.split('|') : [];
                const diasAula = data.dias_aula ? data.dias_aula.split('|') : [];

                console.log('üìç Preenchendo', unidades.length, 'unidades');

                // Primeiro, criar todas as unidades necess√°rias
                for (let i = 1; i < unidades.length; i++) {
                    const addButton = document.querySelector('.add-location-btn');
                    if (addButton) {
                        console.log('‚ûï Adicionando unidade', i + 1);
                        addButton.click();
                    }
                }

                // Aguardar um pouco para as unidades serem criadas, ent√£o preencher
                setTimeout(function () {
                    for (let i = 0; i < unidades.length; i++) {
                        console.log('üìù Preenchendo unidade', i + 1, ':', unidades[i]);

                        const enderecoInputs = document.querySelectorAll('input[name="endereco_unidade[]"]');
                        const bairroInputs = document.querySelectorAll('input[name="bairro_unidade[]"]');
                        const vagasInputs = document.querySelectorAll('input[name="vagas_unidade[]"]');
                        const inicioInputs = document.querySelectorAll('input[name="inicio_aulas_data[]"]');
                        const fimInputs = document.querySelectorAll('input[name="fim_aulas_data[]"]');
                        const horarioInicioSelects = document.querySelectorAll('select[name="horario_inicio[]"]');
                        const horarioFimSelects = document.querySelectorAll('select[name="horario_fim[]"]');
                        const diasAulaSelects = document.querySelectorAll('select[name="dias_aula[]"]');

                        // Preencher campos b√°sicos
                        if (enderecoInputs[i]) enderecoInputs[i].value = enderecos[i] || '';
                        if (bairroInputs[i]) bairroInputs[i].value = bairros[i] || '';
                        if (vagasInputs[i]) vagasInputs[i].value = vagas[i] || '';

                        // Preencher datas (converter formato se necess√°rio)
                        if (inicioInputs[i] && inicioAulas[i]) {
                            const dataInicio = converterDataParaInput(inicioAulas[i]);
                            inicioInputs[i].value = dataInicio;
                        }
                        if (fimInputs[i] && fimAulas[i]) {
                            const dataFim = converterDataParaInput(fimAulas[i]);
                            fimInputs[i].value = dataFim;
                        }

                        // Preencher hor√°rios
                        if (horarioInicioSelects[i] && horarioInicio[i]) {
                            horarioInicioSelects[i].value = horarioInicio[i];
                        }
                        if (horarioFimSelects[i] && horarioFim[i]) {
                            horarioFimSelects[i].value = horarioFim[i];
                        }

                        // Preencher dias da semana
                        if (diasAulaSelects[i] && diasAula[i]) {
                            diasAulaSelects[i].value = diasAula[i];
                        }
                    }

                    console.log('‚úÖ Todas as unidades preenchidas');
                }, 1000); // Aguardar mais tempo para garantir que todas as unidades foram criadas
            }
        }

        function converterDataParaInput(dataString) {
            // Converter data do formato DD/MM/YYYY ou YYYY-MM-DD para YYYY-MM-DD
            if (!dataString) return '';

            // Se j√° est√° no formato correto (YYYY-MM-DD)
            if (dataString.match(/^\d{4}-\d{2}-\d{2}$/)) {
                return dataString;
            }

            // Se est√° no formato DD/MM/YYYY
            if (dataString.match(/^\d{2}\/\d{2}\/\d{4}$/)) {
                const [dia, mes, ano] = dataString.split('/');
                return `${ano}-${mes}-${dia}`;
            }

            return dataString;
        }

        function preencherCamposOnline(data) {
            console.log('üíª Preenchendo campos online...');

            setTimeout(function () {
                // Plataforma digital
                if (data.plataforma_digital) {
                    const plataformaInput = document.getElementById('plataforma_digital');
                    if (plataformaInput) {
                        plataformaInput.value = data.plataforma_digital;
                        console.log('‚úì Plataforma digital:', data.plataforma_digital);
                    }
                }

                // Aulas ass√≠ncronas
                if (data.aulas_assincronas) {
                    const assincrono = document.getElementById('aulas_assincronas');
                    if (assincrono) {
                        assincrono.value = data.aulas_assincronas;
                        assincrono.dispatchEvent(new Event('change'));
                        console.log('‚úì Aulas ass√≠ncronas:', data.aulas_assincronas);

                        // Se for "n√£o", preencher campos de hor√°rio online
                        if (data.aulas_assincronas === 'nao') {
                            setTimeout(function () {
                                // Preencher hor√°rios online se existirem
                                if (data.horario_inicio) {
                                    const horarioInicioOnline = document.getElementById('horario_inicio_online');
                                    if (horarioInicioOnline) {
                                        horarioInicioOnline.value = data.horario_inicio;
                                        console.log('‚úì Hor√°rio in√≠cio online:', data.horario_inicio);
                                    }
                                }

                                if (data.horario_fim) {
                                    const horarioFimOnline = document.getElementById('horario_fim_online');
                                    if (horarioFimOnline) {
                                        horarioFimOnline.value = data.horario_fim;
                                        console.log('‚úì Hor√°rio fim online:', data.horario_fim);
                                    }
                                }

                                if (data.dias_aula) {
                                    const diasAulaOnline = document.getElementById('dias_aula_online');
                                    if (diasAulaOnline) {
                                        diasAulaOnline.value = data.dias_aula;
                                        console.log('‚úì Dias aula online:', data.dias_aula);
                                    }
                                }

                                // Datas de aulas online
                                if (data.inicio_aulas_data) {
                                    const inicioAulasOnline = document.getElementById('inicio_aulas_data_online');
                                    if (inicioAulasOnline) {
                                        const dataInicio = converterDataParaInput(data.inicio_aulas_data);
                                        inicioAulasOnline.value = dataInicio;
                                        console.log('‚úì In√≠cio aulas online:', dataInicio);
                                    }
                                }

                                if (data.fim_aulas_data) {
                                    const fimAulasOnline = document.getElementById('fim_aulas_data_online');
                                    if (fimAulasOnline) {
                                        const dataFim = converterDataParaInput(data.fim_aulas_data);
                                        fimAulasOnline.value = dataFim;
                                        console.log('‚úì Fim aulas online:', dataFim);
                                    }
                                }
                            }, 300);
                        }
                    }
                }

                console.log('‚úÖ Campos online preenchidos');
            }, 200);
        }

        function preencherCamposComuns(data) {
            console.log('üîß Preenchendo campos comuns...');

            // Campos de valores - curso gratuito
            if (data.curso_gratuito) {
                const gratuito = document.getElementById('curso_gratuito');
                if (gratuito) {
                    gratuito.value = data.curso_gratuito;
                    gratuito.dispatchEvent(new Event('change'));
                }
            }

            // Outros campos simples
            const camposSimples = [
                'carga_horaria', 'publico_alvo', 'acessibilidade',
                'oferece_certificado', 'info_complementares', 'parceiro_externo',
                'oferece_bolsa'
            ];

            setTimeout(function () {
                camposSimples.forEach(campo => {
                    if (data[campo]) {
                        const elemento = document.getElementById(campo);
                        if (elemento) {
                            elemento.value = data[campo];
                            elemento.dispatchEvent(new Event('change'));
                            console.log('‚úì Campo preenchido:', campo, '=', data[campo]);
                        }
                    }
                });

                // Aguardar campos condicionais carregarem
                setTimeout(function () {
                    // Campos condicionais de parceiro
                    if (data.parceiro_externo === 'sim') {
                        if (data.parceiro_nome) {
                            const nomeInput = document.getElementById('parceiro_nome');
                            if (nomeInput) {
                                nomeInput.value = data.parceiro_nome;
                                console.log('‚úì Parceiro nome:', data.parceiro_nome);
                            }
                        }
                        if (data.parceiro_link) {
                            const linkInput = document.getElementById('parceiro_link');
                            if (linkInput) {
                                linkInput.value = data.parceiro_link;
                                console.log('‚úì Parceiro link:', data.parceiro_link);
                            }
                        }
                    }

                    // Campos condicionais de acessibilidade
                    if (data.acessibilidade === 'acessivel' || data.acessibilidade === 'exclusivo') {
                        if (data.recursos_acessibilidade) {
                            const recursosInput = document.getElementById('recursos_acessibilidade');
                            if (recursosInput) {
                                recursosInput.value = data.recursos_acessibilidade;
                                console.log('‚úì Recursos acessibilidade preenchidos');
                            }
                        }
                    }

                    // Campos condicionais de certificado
                    if (data.oferece_certificado === 'sim') {
                        if (data.pre_requisitos) {
                            const preRequisitosInput = document.getElementById('pre_requisitos');
                            if (preRequisitosInput) {
                                preRequisitosInput.value = data.pre_requisitos;
                                console.log('‚úì Pr√©-requisitos preenchidos');
                            }
                        }
                    }

                    // Campos condicionais de bolsa
                    if (data.oferece_bolsa === 'sim') {
                        if (data.valor_bolsa) {
                            const valorBolsaInput = document.getElementById('valor_bolsa');
                            if (valorBolsaInput) {
                                valorBolsaInput.value = data.valor_bolsa;
                                console.log('‚úì Valor bolsa preenchido');
                            }
                        }
                        if (data.requisitos_bolsa) {
                            const requisitosBolsaInput = document.getElementById('requisitos_bolsa');
                            if (requisitosBolsaInput) {
                                requisitosBolsaInput.value = data.requisitos_bolsa;
                                console.log('‚úì Requisitos bolsa preenchidos');
                            }
                        }
                    }

                    // Campos condicionais de curso pago
                    if (data.curso_gratuito === 'nao') {
                        if (data.valor_curso) {
                            const valorCursoInput = document.getElementById('valor_curso');
                            if (valorCursoInput) {
                                valorCursoInput.value = data.valor_curso;
                                console.log('‚úì Valor curso preenchido');
                            }
                        }
                        if (data.valor_curso_inteira) {
                            const valorInteiraInput = document.getElementById('valor_curso_inteira');
                            if (valorInteiraInput) {
                                valorInteiraInput.value = data.valor_curso_inteira;
                                console.log('‚úì Valor inteira preenchido');
                            }
                        }
                        if (data.valor_curso_meia) {
                            const valorMeiaInput = document.getElementById('valor_curso_meia');
                            if (valorMeiaInput) {
                                valorMeiaInput.value = data.valor_curso_meia;
                                console.log('‚úì Valor meia preenchido');
                            }
                        }
                        if (data.requisitos_meia) {
                            const requisitosMeiaInput = document.getElementById('requisitos_meia');
                            if (requisitosMeiaInput) {
                                requisitosMeiaInput.value = data.requisitos_meia;
                                console.log('‚úì Requisitos meia preenchidos');
                            }
                        }
                    }

                    console.log('‚úÖ Campos comuns preenchidos completamente');
                }, 600);
            }, 400);
        }
    </script>
    {% endif %}

    <!-- SCRIPT DE DEBUG PARA GARANTIR ENVIO DO FORMUL√ÅRIO -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.querySelector('.course-form');
            const submitBtn = document.getElementById('submitBtn');

            console.log('üîß Script de debug carregado');
            console.log('Formul√°rio encontrado:', !!form);
            console.log('Bot√£o submit encontrado:', !!submitBtn);
            console.log('Loading manager dispon√≠vel:', !!window.loadingManager);
            
            // Verificar se h√° loading ativo e fechar se necess√°rio
            if (window.loadingManager && window.loadingManager.overlay && 
                window.loadingManager.overlay.classList.contains('active')) {
                console.log('üîÑ Loading ativo detectado, fechando...');
                window.loadingManager.hide();
            }

            if (form && submitBtn) {
                // Verificar se j√° tem listener para evitar duplica√ß√£o
                if (!submitBtn.hasAttribute('data-debug-listener')) {
                    submitBtn.setAttribute('data-debug-listener', 'true');
                    
                    // Adicionar listener direto no bot√£o
                    submitBtn.addEventListener('click', function (e) {
                    console.log('üöÄ Bot√£o clicado!');

                    // Verificar se o formul√°rio √© v√°lido usando HTML5 validation
                    if (form.checkValidity()) {
                        console.log('‚úÖ Formul√°rio v√°lido, permitindo envio...');

                        // Mostrar loading overlay
                        if (window.loadingManager) {
                            window.loadingManager.show();
                            console.log('üîÑ Loading overlay ativado');
                        }

                        // Mostrar loading no bot√£o tamb√©m
                        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Criando Curso...';
                        submitBtn.disabled = true;

                        // Permitir que o comportamento padr√£o continue (envio do formul√°rio)
                        return true;
                    } else {
                        console.log('‚ùå Formul√°rio inv√°lido');
                        e.preventDefault();

                        // Mostrar quais campos s√£o inv√°lidos
                        const invalidFields = form.querySelectorAll(':invalid');
                        console.log('Campos inv√°lidos:', invalidFields);
                        invalidFields.forEach(field => {
                            console.log(`- ${field.name}: ${field.validationMessage}`);
                        });

                        alert('Por favor, preencha todos os campos obrigat√≥rios.');
                        return false;
                    }
                    });
                }

                // Listener adicional no formul√°rio como fallback
                form.addEventListener('submit', function (e) {
                    console.log('üìù Evento submit disparado no formul√°rio');
                    console.log('Formul√°rio v√°lido:', form.checkValidity());
                    
                    // Fallback: garantir que loading apare√ßa mesmo se o listener do bot√£o falhar
                    if (form.checkValidity() && window.loadingManager) {
                        window.loadingManager.show();
                        console.log('üîÑ Loading overlay ativado via fallback');
                    }

                    // Log dos dados do formul√°rio
                    const formData = new FormData(form);
                    console.log('Dados do formul√°rio:');
                    for (let [key, value] of formData.entries()) {
                        if (value) console.log(`${key}: ${value}`);
                    }
                });
            }
        });
    </script>
</body>

</html>